<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BountyHound Local - Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Courier New', monospace; background: #0a0a0a; color: #00ff41; min-height: 100vh; }
        .header { background: #111; border-bottom: 2px solid #00ff41; padding: 20px; text-align: center; }
        .header h1 { font-size: 2em; letter-spacing: 4px; }
        .header .subtitle { color: #666; margin-top: 5px; }
        .stats-bar { display: flex; justify-content: center; gap: 40px; padding: 20px; background: #0d0d0d; border-bottom: 1px solid #222; }
        .stat { text-align: center; }
        .stat .value { font-size: 2.5em; font-weight: bold; }
        .stat .label { color: #666; font-size: 0.8em; text-transform: uppercase; }
        .stat.critical .value { color: #ff4444; }
        .stat.high .value { color: #ff8800; }
        .stat.active .value { color: #00ff41; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .section { margin-bottom: 30px; }
        .section h2 { border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 15px; font-size: 1.2em; }
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; padding: 10px; color: #00ff41; border-bottom: 2px solid #333; font-size: 0.85em; text-transform: uppercase; }
        td { padding: 10px; border-bottom: 1px solid #1a1a1a; color: #ccc; font-size: 0.9em; }
        tr:hover { background: #111; }
        .status { padding: 3px 8px; border-radius: 3px; font-size: 0.8em; font-weight: bold; }
        .status.running { background: #003300; color: #00ff41; }
        .status.complete { background: #333; color: #999; }
        .status.pending { background: #332200; color: #ff8800; }
        .status.failed { background: #330000; color: #ff4444; }
        .severity { padding: 2px 6px; border-radius: 2px; font-size: 0.75em; font-weight: bold; }
        .severity.critical { background: #440000; color: #ff4444; }
        .severity.high { background: #442200; color: #ff8800; }
        .severity.medium { background: #444400; color: #ffff00; }
        .severity.low { background: #004400; color: #00ff41; }
        .actions { display: flex; gap: 10px; margin-bottom: 20px; }
        .btn { padding: 10px 20px; background: #001a00; border: 1px solid #00ff41; color: #00ff41; cursor: pointer; font-family: inherit; font-size: 0.9em; }
        .btn:hover { background: #003300; }
        .btn.danger { border-color: #ff4444; color: #ff4444; }
        .btn.danger:hover { background: #330000; }
        #add-target { display: none; background: #111; border: 1px solid #333; padding: 20px; margin-bottom: 20px; }
        #add-target input { background: #0a0a0a; border: 1px solid #333; color: #00ff41; padding: 8px; font-family: inherit; margin: 5px 0; width: 100%; }
        .refresh-timer { color: #444; font-size: 0.8em; }
        footer { text-align: center; padding: 20px; color: #333; border-top: 1px solid #1a1a1a; margin-top: 40px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>BOUNTY HOUND LOCAL</h1>
        <div class="subtitle">Autonomous Bug Bounty Hunting Swarm | H100 NVL</div>
    </div>

    <div class="stats-bar">
        <div class="stat active">
            <div class="value">{{ total_targets }}</div>
            <div class="label">Targets</div>
        </div>
        <div class="stat high">
            <div class="value">{{ active_hunts|length }}</div>
            <div class="label">Active Hunts</div>
        </div>
        <div class="stat critical">
            <div class="value">{{ total_findings }}</div>
            <div class="label">Total Findings</div>
        </div>
        <div class="stat">
            <div class="value">{{ stats.get('hunts_completed', 0) }}</div>
            <div class="label">Hunts Complete</div>
        </div>
    </div>

    <div class="container">
        <div class="actions">
            <button class="btn" onclick="toggleAddTarget()">+ Add Target</button>
            <button class="btn" onclick="startSwarm()">Start Swarm</button>
            <button class="btn" onclick="location.reload()">Refresh</button>
            <span class="refresh-timer">Auto-refreshes every 30s</span>
        </div>

        <div id="add-target">
            <h3>Add Target</h3>
            <input type="text" id="new-domain" placeholder="example.com">
            <input type="text" id="new-platform" placeholder="Platform: hackerone, bugcrowd, intigriti, private" value="private">
            <input type="number" id="new-priority" placeholder="Priority (1-10)" value="5" min="1" max="10">
            <input type="text" id="new-notes" placeholder="Notes (tech stack, tips, etc.)">
            <br><button class="btn" onclick="addTarget()">Add</button>
        </div>

        {% if active_hunts %}
        <div class="section">
            <h2>Active Hunts</h2>
            <table>
                <tr><th>Hunt ID</th><th>Target</th><th>Phase</th><th>Status</th><th>Started</th></tr>
                {% for hunt in active_hunts %}
                <tr>
                    <td>#{{ hunt.id }}</td>
                    <td>{{ hunt.target_id }}</td>
                    <td>{{ hunt.phase }}</td>
                    <td><span class="status running">{{ hunt.status }}</span></td>
                    <td>{{ hunt.started_at }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>
        {% endif %}

        <div class="section">
            <h2>Targets ({{ targets|length }})</h2>
            <table>
                <tr><th>Domain</th><th>Platform</th><th>Priority</th><th>Findings</th><th>Last Hunt</th><th>Status</th><th>Actions</th></tr>
                {% for t in targets %}
                <tr>
                    <td>{{ t.domain }}</td>
                    <td>{{ t.platform }}</td>
                    <td>{{ t.priority }}</td>
                    <td>{{ t.total_findings }}</td>
                    <td>{{ t.last_full_hunt_at or 'Never' }}</td>
                    <td><span class="status {{ t.status }}">{{ t.status }}</span></td>
                    <td><button class="btn" onclick="startHunt('{{ t.domain }}')">Hunt</button></td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>

    <footer>BountyHound Local v1.0.0 | Running on H100 NVL | All testing authorized</footer>

    <script>
        function toggleAddTarget() {
            const el = document.getElementById('add-target');
            el.style.display = el.style.display === 'none' ? 'block' : 'none';
        }

        async function addTarget() {
            const domain = document.getElementById('new-domain').value;
            const platform = document.getElementById('new-platform').value;
            const priority = parseInt(document.getElementById('new-priority').value);
            const notes = document.getElementById('new-notes').value;

            const resp = await fetch('/api/targets', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({domain, platform, priority, notes})
            });
            const data = await resp.json();
            alert(`Target added: ${data.domain}`);
            location.reload();
        }

        async function startHunt(domain) {
            const resp = await fetch('/api/hunts', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({domain})
            });
            const data = await resp.json();
            alert(`Hunt dispatched for ${domain} (task: ${data.hunt_task_id})`);
            location.reload();
        }

        async function startSwarm() {
            const resp = await fetch('/api/swarm/start', {method: 'POST'});
            const data = await resp.json();
            alert(`Swarm started: ${JSON.stringify(data)}`);
            location.reload();
        }

        // Auto-refresh every 30 seconds
        setTimeout(() => location.reload(), 30000);
    </script>
</body>
</html>
