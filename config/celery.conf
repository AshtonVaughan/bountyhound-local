# BountyHound Local - Celery Configuration

broker_url: "redis://localhost:6379/0"
result_backend: "redis://localhost:6379/1"

# Task routing - each queue maps to a model tier
task_routes:
  "workers.recon.*": {"queue": "recon"}
  "workers.discovery.*": {"queue": "discovery"}
  "workers.exploit.*": {"queue": "exploit"}
  "workers.validator.*": {"queue": "validate"}
  "workers.reporter.*": {"queue": "report"}
  "workers.auth.*": {"queue": "auth"}
  "orchestrator.*": {"queue": "orchestrate"}

# Worker concurrency per queue
worker_concurrency:
  orchestrate: 1     # Single orchestrator thread
  recon: 3           # 3 parallel recon jobs (CLI-bound, not GPU)
  discovery: 2       # 2 parallel discovery reasoning sessions
  exploit: 2         # 2 parallel exploit generation sessions
  validate: 4        # 4 parallel PoC validations (mostly curl)
  report: 1          # 1 report at a time
  auth: 1            # 1 auth session at a time (browser)

# Task settings
task_serializer: "json"
result_serializer: "json"
accept_content: ["json"]
timezone: "UTC"
task_track_started: true
task_acks_late: true
worker_prefetch_multiplier: 1

# Beat schedule (periodic tasks)
beat_schedule:
  light-retest:
    task: "orchestrator.schedule_light_retest"
    schedule: 43200  # 12 hours in seconds
  full-retest:
    task: "orchestrator.schedule_full_retest"
    schedule: 604800  # 7 days in seconds
  token-refresh:
    task: "workers.auth.check_token_expiry"
    schedule: 600  # 10 minutes
  health-check:
    task: "orchestrator.health_check"
    schedule: 300  # 5 minutes
